<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:conv="clr-namespace:LearnCode.Client.Converters"
                    xmlns:local="clr-namespace:LearnCode.Client">

    <conv:SearchTextToVisibilityConverter x:Key="SearchTextToVisibilityConverter"/>
    <conv:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>

    <Style TargetType="{x:Type local:FderivsDataGrid}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:FderivsDataGrid}">

                    <Border Background="{TemplateBinding Background}"  
                            BorderBrush="{TemplateBinding BorderBrush}"  
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <StackPanel Orientation="Vertical" DataContext="{TemplateBinding DataContext}">



                            <Grid DataContext="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type UserControl}}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="24"/>
                                    <RowDefinition Height="1*"/>
                                    <RowDefinition Height="24"/>
                                </Grid.RowDefinitions>

                                <TextBox Width="200" Margin="2" Grid.Row="0" HorizontalAlignment="Left" x:Name="txtFullTextSearch"   
                                     Visibility="{TemplateBinding EnableFullTextSearch, Converter={StaticResource BooleanToVisibilityConverter}}" />

                                <DataGrid    
                                      Grid.Row="1"
                                      ItemsSource="{TemplateBinding ItemsSource}" CanUserAddRows="{TemplateBinding CanUserAddRows}"  
                                      CanUserDeleteRows="{TemplateBinding CanUserDeleteRows}"   
                                      AutoGenerateColumns="{TemplateBinding AutoGenerateColumns}">
                                    <DataGrid.ItemContainerStyle>
                                        <Style TargetType="{x:Type DataGridRow}">
                                            <Setter Property="Visibility">
                                                <Setter.Value>
                                                    <MultiBinding Converter="{StaticResource SearchTextToVisibilityConverter}">
                                                        <Binding ElementName="txtFullTextSearch" Path="Text"/>
                                                        <Binding BindsDirectlyToSource="True"/>
                                                    </MultiBinding>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </DataGrid.ItemContainerStyle>
                                </DataGrid>

                                <Button Grid.Row="2" Content="First Page" Command="{Binding Command}" />
                            </Grid>



                        </StackPanel>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>